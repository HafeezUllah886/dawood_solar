<?php
 namespace App\Http\Controllers; use App\Models\scrapeSale; use App\Http\Controllers\Controller; use App\Models\accounts; use App\Models\scrapStock; use App\Models\transactions; use Illuminate\Http\Request; class ScrapeSaleController extends Controller { public function index() { $scrapeSales = scrapeSale::orderBy("\151\144", "\x64\145\x73\143")->get(); $accounts = accounts::business()->get(); $cr = scrapStock::sum("\143\162"); $db = scrapStock::sum("\x64\x62"); $stock = $cr - $db; return view("\163\x63\x72\141\160\x65\56\x73\141\x6c\x65\56\x69\156\144\145\x78", compact("\x73\x63\162\x61\x70\x65\x53\141\154\x65\163", "\141\143\x63\x6f\x75\x6e\164\163", "\163\164\x6f\x63\x6b")); } public function create() { } public function store(Request $request) { $refID = getRef(); $request->merge(array("\x72\x65\x66\111\x44" => $refID)); $sale = scrapeSale::create($request->except("\141\143\x63\x6f\165\x6e\164\111\x44")); scrapStock::create(array("\x64\x61\164\145" => $request->date, "\x64\x62" => $request->weight, "\x72\145\x66\111\x44" => $refID, "\x6e\157\164\145\x73" => $request->notes)); createTransaction($request->accountID, $request->date, $request->amount, 0, "\x50\141\x79\155\x65\156\x74\x20\x6f\x66\x20\x53\143\162\x61\x70\40\x53\x61\154\x65", $refID, "\x53\143\x72\141\x70\x20\x53\141\154\145"); return redirect()->route("\x73\143\x72\141\160\x5f\x73\x61\154\x65\x2e\x69\x6e\x64\x65\170")->with("\163\x75\x63\143\145\x73\163", "\123\143\162\141\x70\x20\123\x61\x6c\x65\x20\103\162\x65\x61\164\145\144"); } public function show(scrapeSale $scrapeSale) { } public function edit(scrapeSale $scrapeSale) { } public function update(Request $request, scrapeSale $scrapeSale) { } public function destroy($ref) { scrapeSale::where("\x72\145\x66\x49\104", $ref)->delete(); scrapStock::where("\162\145\146\111\104", $ref)->delete(); transactions::where("\162\145\x66\111\104", $ref)->delete(); session()->forget("\143\x6f\156\x66\151\162\155\x65\x64\x5f\160\141\x73\163\x77\157\162\144"); return redirect()->route("\x73\143\162\x61\160\137\x73\141\154\145\x2e\x69\x6e\144\145\x78")->with("\x73\x75\x63\143\x65\x73\163", "\123\x63\162\141\160\x20\123\x61\154\145\x20\x44\145\x6c\145\164\145\144"); } }