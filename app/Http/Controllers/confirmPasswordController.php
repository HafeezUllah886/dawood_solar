<?php
 namespace App\Http\Controllers; use Illuminate\Http\Request; use Illuminate\Support\Facades\Hash; use Illuminate\Support\Facades\Session; class confirmPasswordController extends Controller { public function showConfirmPasswordForm() { return view("\141\x75\x74\150\x2e\143\x6f\156\x66\x69\162\155\120\141\163\163\x77\157\162\x64"); } public function confirmPassword(Request $request) { $request->validate(array("\160\x61\163\163\x77\x6f\x72\144" => "\x72\145\161\x75\151\162\145\144")); if (Hash::check($request->password, auth()->user()->password)) { session(array("\143\x6f\156\x66\x69\x72\x6d\x65\144\x5f\x70\141\163\163\167\x6f\162\x64" => true)); $intendedUrl = Session::get("\151\x6e\x74\x65\x6e\x64\145\144\137\x75\162\x6c", "\57"); Session::forget("\x69\156\164\x65\x6e\144\145\144\137\165\162\x6c"); return redirect($intendedUrl); } else { return redirect(Session::get("\x70\x72\x65\166\137\x75\x72\154", "\x2f"))->with("\145\x72\x72\157\162", "\x57\162\157\156\147\40\120\141\x73\x73\x77\x6f\162\x64"); } } }