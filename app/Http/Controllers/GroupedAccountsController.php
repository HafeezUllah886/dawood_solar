<?php
 namespace App\Http\Controllers; use App\Models\groupedAccounts; use App\Http\Controllers\Controller; use App\Models\accounts; use App\Models\transactions; use Illuminate\Http\Request; class GroupedAccountsController extends Controller { public function index() { $groups = groupedAccounts::all(); $accounts = accounts::all(); return view("\106\x69\156\141\x6e\143\x65\56\147\x72\x6f\x75\x70\x73\56\x69\156\144\145\170", compact("\x67\162\157\165\160\x73", "\x61\143\x63\x6f\x75\156\x74\163")); } public function create() { } public function store(Request $request) { $request->validate(array("\x67\x72\x6f\x75\160\x5f\x6e\x61\155\x65" => "\162\x65\x71\x75\x69\x72\145\x64\x7c\165\x6e\151\161\x75\145\x3a\147\162\x6f\165\160\x65\x64\x5f\141\x63\x63\x6f\x75\156\x74\163\x2c\147\x72\157\165\x70\x5f\156\x61\x6d\x65", "\x61\x63\143\157\x75\156\164\61" => "\x72\x65\161\x75\151\162\145\144", "\x61\x63\x63\x6f\x75\156\164\62" => "\162\145\161\165\x69\x72\145\x64\174\144\x69\146\x66\x65\162\x65\156\x74\x3a\141\x63\143\x6f\165\156\164\x31")); groupedAccounts::create(array("\147\162\157\165\x70\x5f\156\x61\x6d\x65" => $request->group_name, "\141\x63\143\x6f\x75\156\164\x31\137\x69\x64" => $request->account1, "\x61\143\x63\x6f\165\156\164\62\137\x69\x64" => $request->account2)); return redirect()->route("\x67\x72\x6f\165\x70\163\x2e\x69\x6e\x64\145\170")->with("\x73\165\143\143\x65\x73\x73", "\x47\x72\157\x75\x70\40\x63\x72\x65\x61\x74\145\144\40\x73\165\143\x63\x65\x73\163\146\x75\154\154\171"); } public function show($id, $from, $to) { $group = groupedAccounts::find($id); $ids = array($group->account1_id, $group->account2_id); $transactions = transactions::whereIn("\x61\x63\143\157\165\156\164\x49\104", $ids)->whereBetween("\x64\141\x74\145", array($from, $to))->get(); $pre_cr = transactions::whereIn("\141\143\x63\157\165\x6e\164\x49\104", $ids)->whereDate("\144\141\164\x65", "\x3c", $from)->sum("\143\x72"); $pre_db = transactions::whereIn("\x61\x63\x63\157\165\156\164\x49\104", $ids)->whereDate("\144\x61\164\145", "\74", $from)->sum("\144\x62"); $pre_balance = $pre_cr - $pre_db; $cur_cr = transactions::whereIn("\x61\143\143\x6f\x75\156\164\x49\x44", $ids)->sum("\143\162"); $cur_db = transactions::whereIn("\141\143\x63\x6f\165\156\164\x49\x44", $ids)->sum("\144\142"); $cur_balance = $cur_cr - $cur_db; return view("\x46\151\x6e\x61\x6e\x63\x65\x2e\x67\162\157\x75\x70\x73\56\x73\164\141\x74\155\x65\156\x74", compact("\x67\162\x6f\x75\x70", "\x74\162\x61\x6e\x73\141\x63\x74\x69\157\156\x73", "\160\162\145\x5f\142\x61\154\141\x6e\143\145", "\143\165\162\137\x62\x61\x6c\x61\156\x63\x65", "\146\x72\x6f\x6d", "\x74\x6f")); } public function edit(groupedAccounts $groupedAccounts) { } public function update(Request $request, groupedAccounts $groupedAccounts) { } public function delete($id) { groupedAccounts::find($id)->delete(); session()->forget("\x63\157\x6e\146\x69\x72\x6d\x65\x64\x5f\160\141\x73\x73\167\x6f\x72\144"); return redirect()->route("\x67\x72\x6f\165\160\163\x2e\151\x6e\144\x65\170")->with("\163\165\143\x63\145\x73\x73", "\107\x72\x6f\x75\160\x20\144\145\x6c\x65\x74\x65\x64\40\163\165\x63\143\145\163\x73\146\165\154\154\171"); } }